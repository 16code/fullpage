/* 
 * Chriswang
 * 396276123@qq.com
 * 2014.11.11
 * Github:https://github.com/powy1993/fullpage
 */

function FullPage(a){"use strict";function B(a,b,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*b,this.by=3*(d-b)-this.cy,this.ay=1-this.cy-this.by}var l,m,r,s,t,u,v,w,x,y,z,A,b=document.getElementById(a.id),c=b.children,d=c.length,e=d,f=a.slideTime||800,g=0,h={},i={},j={},k=[],n=" ",o=null,p=!1,q=!1;if(c&&1!==d){if(a.mode&&(q=-1!==a.mode.indexOf("nav:"),k=a.mode.split(","),l=k.length),h={addEventListener:!!window.addEventListener,gravity:!!window.DeviceOrientationEvent,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,versionAndroid:function(){var c,a=navigator.userAgent,b=a.indexOf("Android");return-1!==b&&(c=a.substring(b+7,b+11).replace(" ","")),c||0}(),cssCore:function(a){switch(!0){case""===a.webkitTransition:return"webkit";case""===a.MozTransition:return"Moz";case""===a.msTransition:return"ms";case""===a.OTransition:return"O";default:return""}}(document.createElement("Chriswang").style)},B.prototype={epsilon:1e-5,sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,b){var c,d,e,f,g,h;for(e=a,h=0;8>h;h++){if(f=this.sampleCurveX(e)-a,Math.abs(f)<b)return e;if(g=this.sampleCurveDerivativeX(e),Math.abs(g)<b)break;e-=f/g}if(c=0,d=1,e=a,c>e)return c;if(e>d)return d;for(;d>c;){if(f=this.sampleCurveX(e),Math.abs(f-a)<b)return e;a>f?c=e:d=e,e=.5*(d-c)+c}return e},solve:function(a,b){return this.sampleCurveY(this.solveCurveX(a,b))}},t=function(){b.style.height=document.documentElement.clientHeight+"px"||window.innerHeight+"px",i={X:b.offsetWidth,Y:b.offsetHeight}},u=function(a,b,c,d){j.A=a,j.B=b,j.C=c,j.D=d},"string"==typeof a.easing)switch(a.animate){case"ease":u(.25,.1,.25,1);break;case"linear":u(0,0,1,1);break;case"ease-in":u(.42,0,1,1);break;case"ease-out":u(0,0,.58,1);break;case"ease-in-out":u(.42,0,.58,1)}else u(a.easing[0],a.easing[1],a.easing[2],a.easing[3]);if(""!==h.cssCore){for(;e--;)c[e].style[h.cssCore+"TransitionTimingFunction"]="cubic-bezier("+j.A+","+j.B+","+j.C+","+j.D+")";v=function(a,b,c,d){var e=a.style;e[h.cssCore+"TransitionDuration"]=d+"ms",e[h.cssCore+"Transform"]="translate("+b+"px,"+c+"px) translateZ(0)"}}else r=new B(j.A,j.B,j.C,j.D),v=function(a,b,c,d){var n,e=a.currentStyle,f=a.style,g=parseInt(f.left||e.left,10),h=parseInt(f.top||e.top,10),i=b-g,j=c-h,k=+new Date,l=k+d,m=0;clearInterval(o),o=setInterval(function(){+new Date>l?(f.cssText="left:"+b+"px;top:"+c+"px;",clearInterval(o)):(n=l-new Date,m=n/d,m=r.solve(1-m,B.prototype.epsilon),f.cssText="left:"+(g+i*m)+"px;top:"+(h+j*m)+"px;")},13)};for(w=h.addEventListener&&h.touch?function(a,b){a.addEventListener("touchstart",b,!1)}:function(a,b){a.onclick=b},x=function(a,b,c){var f,d=a.className,e=[];if(-1!==d.indexOf(b)){for(e=d.split(n),f=e.length;f--;)e[f]===b&&(c===n||""===c?e.splice(f,1):e[f]=c);e.length?a.className=e.join(n):(a.removeAttribute("class"),a.removeAttribute("className"))}},q&&(z=function(a,b){var c=m[b].className;x(m[a],"active",n),m[b].className=""===c?"active":c+" active"}),y=function(b){var e,j,k;if(!(p||b===g||b>=d||0>b)){switch(p=!0,a.direction){case"Y":e=b>g?i.Y:-i.Y,v(c[b],0,e,0);break;case"X":e=b>g?i.X:-i.X,v(c[b],e,0,0);break;case"XY":e={X:b>g?i.X:-i.X,Y:b>g?i.Y:-i.Y},v(c[b],e.X,e.Y,0)}j=""===h.cssCore?20:0,k=g,g=b,q&&z(k,g),setTimeout(function(){c[b].className+=" slide"},j),setTimeout(function(){v(c[b],0,0,f),setTimeout(function(){x(c[k],"current",""),x(c[g],"slide","current"),a.callback&&a.callback(g,c[g]),p=!1},f)},50)}},t(),s=c[g].className,c[g].className=-1!==s.indexOf("current")?s:s+" current",h.addEventListener?window.addEventListener("resize",t,!1):window.onresize=t;l--;)!function(c){switch(!0){case"wheel"===c:A=function(a){var b;a=a||window.event,a.preventDefault?a.preventDefault():a.returnValue=!1,b=-a.wheelDelta||a.detail,b=0>b?-1:1,y(g+b)},h.addEventListener&&document.addEventListener("DOMMouseScroll",A,!1),window.onmousewheel=document.onmousewheel=A;break;case"touch"===c:if(!h.touch||!h.addEventListener)break;!function(){var c={},d={};c={start:function(a){var e=a.touches[0];d={x:e.pageX,y:e.pageY,time:+new Date},b.addEventListener("touchmove",c.move,!1),b.addEventListener("touchend",c.end,!1)},move:function(a){event.touches.length>1||event.scale&&1!==event.scale||a.preventDefault()},end:function(b){var c=b.changedTouches[0],e=+new Date-d.time,f={},h=0,j=!1;switch(f={x:c.pageX-d.x,y:c.pageY-d.y},a.direction){case"Y":j=250>+e&&Math.abs(f.y)>20||Math.abs(f.y)>.3*i.Y,h=f.y>0?-1:1;break;case"X":j=250>+e&&Math.abs(f.x)>20||Math.abs(f.x)>.4*i.Y,h=f.x>0?-1:1;break;case"XY":j=250>+e&&Math.abs(f.y)+Math.abs(f.x)>40||Math.abs(f.y)>.2*i.Y,h=f.y>0?-1:1}j&&y(g+h)}},b.addEventListener("touchstart",c.start,!1)}();break;case-1!==c.indexOf("nav:"):!function(){var d,e,f,a=c.split(":")[1],b=document.getElementById(a);if(m=b.children,d=m.length,f=m[g].className,b&&m){for(;d--;)m[d].setAttribute("data-page",d);-1===f.indexOf("active")&&(m[g].className=""===f?"active":f+" active"),e=function(a){var b;for(a=a||window.event,a=a.target||a.srcElement,b=a.tagName.toLowerCase();"li"!==b;){if("ul"===b)return;a=a.parentNode,b=a.tagName.toLowerCase()}y(+a.getAttribute("data-page"))},w(b,e)}}()}}(k[l]);return{thisPage:function(){return g},go:function(a){y(a)},next:function(){y(g+1)},prev:function(){y(g-1)}}}}