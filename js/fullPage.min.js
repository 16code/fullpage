/* 
 * Chriswang
 * 396276123@qq.com
 * 2014.11.13
 * Github:https://github.com/powy1993/fullpage
 */

function FullPage(a){"use strict";function D(a,b,c,d){this.cx=3*a,this.bx=3*(c-a)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*b,this.by=3*(d-b)-this.cy,this.ay=1-this.cy-this.by}var m,n,s,t,u,v,w,x,y,z,A,B,C,b=document.getElementById(a.id),c=b.children,d=c.length,e=d,f=a.slideTime||800,g=a.effect||{},h=0,i={},j={},k={},l=[],o=" ",p=null,q=!1,r=!1;if(c&&1!==d){if(a.mode&&(r=-1!==a.mode.indexOf("nav:"),l=a.mode.split(","),m=l.length),i={addEventListener:!!window.addEventListener,gravity:!!window.DeviceOrientationEvent,touch:"ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch,versionAndroid:function(){var c,a=navigator.userAgent,b=a.indexOf("Android");return-1!==b&&(c=a.substring(b+7,b+11).replace(" ","")),c||0}(),cssCore:function(a){switch(!0){case""===a.webkitTransition:return"webkit";case""===a.MozTransition:return"Moz";case""===a.msTransition:return"ms";case""===a.OTransition:return"O";default:return""}}(document.createElement("Chriswang").style)},D.prototype={epsilon:1e-5,sampleCurveX:function(a){return((this.ax*a+this.bx)*a+this.cx)*a},sampleCurveY:function(a){return((this.ay*a+this.by)*a+this.cy)*a},sampleCurveDerivativeX:function(a){return(3*this.ax*a+2*this.bx)*a+this.cx},solveCurveX:function(a,b){var c,d,e,f,g,h;for(e=a,h=0;8>h;h++){if(f=this.sampleCurveX(e)-a,Math.abs(f)<b)return e;if(g=this.sampleCurveDerivativeX(e),Math.abs(g)<b)break;e-=f/g}if(c=0,d=1,e=a,c>e)return c;if(e>d)return d;for(;d>c;){if(f=this.sampleCurveX(e),Math.abs(f-a)<b)return e;a>f?c=e:d=e,e=.5*(d-c)+c}return e},solve:function(a,b){return this.sampleCurveY(this.solveCurveX(a,b))}},u=function(){b.style.height=document.documentElement.clientHeight+"px"||window.innerHeight+"px",j={X:b.offsetWidth,Y:b.offsetHeight}},v=function(a,b,c,d){k.A=a,k.B=b,k.C=c,k.D=d},"string"==typeof a.easing)switch(a.easing){case"ease":v(.25,.1,.25,1);break;case"linear":v(0,0,1,1);break;case"ease-in":v(.42,0,1,1);break;case"ease-out":v(0,0,.58,1);break;case"ease-in-out":v(.42,0,.58,1)}else v(a.easing[0],a.easing[1],a.easing[2],a.easing[3]);if(""!==i.cssCore){for(;e--;)c[e].style[i.cssCore+"TransitionTimingFunction"]="cubic-bezier("+k.A+","+k.B+","+k.C+","+k.D+")";w=function(a,b,c,d){var e=a.style,f="translate("+b+"px,"+c+"px) translateZ(0)",g=arguments[4];g.scale&&(f+=0===d?" scale("+g.scale[0]+")":" scale("+g.scale[1]+")"),g.rotate&&(f+=0===d?" rotate("+g.rotate[0]+"deg)":" rotate("+g.rotate[1]+"deg)"),e[i.cssCore+"Transform"]=f}}else s=new D(k.A,k.B,k.C,k.D),w=function(a,b,c,d){var q,e=a.currentStyle,f=a.style,h=parseInt(f.left||e.left,10),i=parseInt(f.top||e.top,10),j=b-h,k=c-i,l=+new Date,m=l+d,n=0,o=g.opacity;clearInterval(p),p=setInterval(function(){var a;+new Date>m?(a=o?"left:"+b+"px;top:"+c+"px;filter:alpha(opacity="+100*o[1]+");":"left:"+b+"px;top:"+c+"px;",clearInterval(p)):(q=m-new Date,n=q/d,n=s.solve(1-n,D.prototype.epsilon),a="left:"+(h+j*n)+"px;top:"+(i+k*n)+"px;",o&&(a+="filter:alpha(opacity="+100*(o[1]*n-o[0]*(1-n))+");")),f.cssText=a},13)};for(x={transform:function(a,b,d){var e=0;switch(a.translate){case"Y":e=d>b?j.Y:-j.Y,w(c[d],0,e,0,a);break;case"X":e=d>b?j.X:-j.X,w(c[d],e,0,0,a);break;case"XY":e={X:d>b?j.X:-j.X,Y:d>b?j.Y:-j.Y},w(c[d],e.X,e.Y,0,a);break;default:w(c[d],0,0,0,a)}setTimeout(function(){w(c[d],0,0,f,a)},""===i.cssCore?0:40)},opacity:function(a,b,d){var e=c[d].style;e.opacity=a[0],setTimeout(function(){e.opacity=a[1]},40)}},y=i.addEventListener&&i.touch?function(a,b){a.addEventListener("touchstart",b,!1),arguments[2]&&a.addEventListener("touchmove",function(a){a.preventDefault()},!1)}:function(a,b){a.onclick=b},z=function(a,b,c){var f,d=a.className,e=[];if(-1!==d.indexOf(b)){for(e=d.split(o),f=e.length;f--;)e[f]===b&&(c===o||""===c?e.splice(f,1):e[f]=c);e.length?a.className=e.join(o):(a.removeAttribute("class"),a.removeAttribute("className"))}},r&&(B=function(a,b){var c=n[b].className;z(n[a],"active",o),n[b].className=""===c?"active":c+" active"}),A=function(b){var e,j,k;if(!(q||b===h||b>=d||0>b)){q=!0;for(k in g)x[k](g[k],h,b);e=""===i.cssCore?20:0,j=h,h=b,r&&B(j,h),setTimeout(function(){c[b].className+=" slide"},e),setTimeout(function(){c[b].style[i.cssCore+"TransitionDuration"]=f+"ms"},20),setTimeout(function(){z(c[j],"current",""),z(c[h],"slide","current"),a.callback&&a.callback(h,c[h]),q=!1},f+50)}},u(),t=c[h].className,c[h].className=-1!==t.indexOf("current")?t:t+" current",i.addEventListener?window.addEventListener("resize",u,!1):window.onresize=u;m--;)!function(c){switch(!0){case"wheel"===c:C=function(a){var b;a=a||window.event,a.preventDefault?a.preventDefault():a.returnValue=!1,q||(b=-a.wheelDelta||a.detail,b=0>b?-1:1,A(h+b))},i.addEventListener&&document.addEventListener("DOMMouseScroll",C,!1),window.onmousewheel=document.onmousewheel=C;break;case"touch"===c:if(!i.touch||!i.addEventListener)break;!function(){var c={},d={};c={start:function(a){var e=a.touches[0];d={x:e.pageX,y:e.pageY,time:+new Date},b.addEventListener("touchmove",c.move,!1),b.addEventListener("touchend",c.end,!1)},move:function(a){event.touches.length>1||event.scale&&1!==event.scale||a.preventDefault()},end:function(b){var c=b.changedTouches[0],e=+new Date-d.time,f={},g={},i=0,k=!1;switch(f={x:c.pageX-d.x,y:c.pageY-d.y},g={x:Math.abs(f.x),y:Math.abs(f.y)},a.effect.transform.translate){case"Y":k=250>+e&&g.y>20||g.y>.3*j.Y,i=f.y>0?-1:1;break;case"X":k=250>+e&&g.x>20||g.x>.4*j.Y,i=f.x>0?-1:1;break;default:k=250>+e&&g.y+g.x>50||g.y>.2*j.Y||g.x>.3*j.X,i=g.x>g.y?f.x>0?-1:1:f.y>0?-1:1}k&&A(h+i)}},b.addEventListener("touchstart",c.start,!1)}();break;case-1!==c.indexOf("nav:"):!function(){var d,e,f,a=c.split(":")[1],b=document.getElementById(a);if(n=b.children,d=n.length,f=n[h].className,b&&n){for(;d--;)n[d].setAttribute("data-page",d);-1===f.indexOf("active")&&(n[h].className=""===f?"active":f+" active"),e=function(a){var b;for(a=a||window.event,a=a.target||a.srcElement,b=a.tagName.toLowerCase();"li"!==b;){if("ul"===b)return;a=a.parentNode,b=a.tagName.toLowerCase()}A(+a.getAttribute("data-page"))},y(b,e,1)}}()}}(l[m]);return{thisPage:function(){return h},go:function(a){A(a)},next:function(){A(h+1)},prev:function(){A(h-1)}}}}